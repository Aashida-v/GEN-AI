<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vediedu - Login</title>
  <!-- Tailwind CSS -->
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; background-color:#000; overflow-x:hidden; overflow-y:auto; }
    .living-background-container{position:fixed;top:0;left:0;width:100%;height:100%;
      background:linear-gradient(-45deg,#134e5e,#71b280,#2dd4bf,#06b6d4,#3b82f6,#1e40af);
      background-size:600% 600%;animation:livingGradient 12s ease infinite;z-index:-20;}
    @keyframes livingGradient{0%{background-position:0% 50%}25%{background-position:100% 0%}
      50%{background-position:50% 100%}75%{background-position:0% 100%}100%{background-position:0% 50%}}
    .orb{position:absolute;border-radius:50%;background:radial-gradient(circle at 30% 30%,rgba(255,255,255,0.3),rgba(255,255,255,0.05));
      animation:floatOrb 8s ease-in-out infinite;z-index:-10;}
    @keyframes floatOrb{0%,100%{transform:translate(0,0) rotate(0deg)}
      25%{transform:translate(50px,-30px) rotate(90deg)}
      50%{transform:translate(-30px,50px) rotate(180deg)}
      75%{transform:translate(-50px,-20px) rotate(270deg)}}
    .form-card{box-shadow:0 4px 6px -1px rgba(0,0,0,0.1),0 2px 4px -1px rgba(0,0,0,0.06);}
    /* New custom styles for validation outlines with thicker, glowing gradient */
        .input-success {
            border-width: 3px;
            border-image: linear-gradient(to right, #10b981, #22c55e); /* Green gradient */
            border-image-slice: 1;
            box-shadow: 0 0 10px #22c55e, 0 0 20px #22c55e;
            transition: border-image 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }

        .input-error {
            border-width: 3px;
            border-image: linear-gradient(to right, #ef4444, #dc2626); /* Red gradient */
            border-image-slice: 1;
            box-shadow: 0 0 10px #dc2626, 0 0 20px #dc2626;
            transition: border-image 0.3s ease-in-out, box-shadow 0.3s ease-in-out;
        }

        input {
            transition: border-color 0.3s ease-in-out;
        }
 </style>
</head>
<body class="bg-black text-white min-h-screen flex items-center justify-center p-4">

  <!-- Background -->
  <div class="living-background-container">
    <div class="orb" style="width:120px;height:120px;top:20%;left:15%"></div>
    <div class="orb" style="width:80px;height:80px;top:60%;left:80%"></div>
    <div class="orb" style="width:150px;height:150px;top:70%;left:20%"></div>
    <div class="orb" style="width:100px;height:100px;top:10%;left:70%"></div>
    <div class="orb" style="width:60px;height:60px;top:40%;left:50%"></div>
  </div>

  <!-- Container -->
  <div class="relative z-10 w-full max-w-sm mx-auto p-4">
    <!-- Logo -->
    <div class="flex flex-col items-center justify-center space-y-4 mb-8">
      <img src="logo.png" alt="Vediedu Logo" class="w-24 h-24 rounded-full"/>
      <h1 class="text-4xl font-bold">Vediedu</h1>
    </div>

    <!-- Card -->
    <div id="form-card" class="form-card bg-gray-900/50 backdrop-blur-lg rounded-xl p-8 border-2 border-white/20">

      <!-- Login Form -->
      <form id="login-form">
        <h2 class="text-2xl font-bold mb-6 text-center">Login</h2>
        <div class="mb-4">
          <label for="login-email" class="block text-white/70 text-sm mb-2 text-left">Email Address</label>
          <input type="email" id="login-email" class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-blue-500" placeholder="your.email@example.com" required>
        </div>
        <div class="mb-6">
          <label for="login-password" class="block text-white/70 text-sm mb-2 text-left">Password</label>
          <input type="password" id="login-password" class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-blue-500" placeholder="••••••••" required>
        </div>
        <button type="submit" class="w-full bg-blue-600 py-2 rounded-lg font-semibold hover:bg-blue-700">Login</button>
        <div id="login-message-box" class="hidden mt-4 p-3 rounded-lg text-sm text-center font-medium"></div>
        <div class="flex justify-between mt-4 text-sm text-white/70">
        <button id="toggle-register" class="text-blue-400 hover:text-blue-300">Don't have an account? Register</button>
        <button id="toggle-reset" class="text-blue-400 hover:text-blue-300">Reset Password</button>
      </div>      
      </form>

      <!-- Register Form -->
      <form id="register-form" class="hidden">
        <h2 class="text-2xl font-bold mb-6 text-center">Create Account</h2>
        <div class="mb-4">
          <label for="register-email" class="block text-white/70 text-sm mb-2 text-left">Email Address</label>
          <input type="email" id="register-email" class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-blue-500" required>
        </div>
        <div class="mb-4">
          <label for="register-password" class="block text-white/70 text-sm mb-2 text-left">Password</label>
          <input type="password" id="register-password" class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-blue-500" required>
        </div>
        <div class="mb-6">
          <label for="confirm-password" class="block text-white/70 text-sm mb-2 text-left">Confirm Password</label>
          <input type="password" id="confirm-password" class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-blue-500" required>
        </div>
        <button type="submit" class="w-full bg-blue-600 py-2 rounded-lg font-semibold hover:bg-blue-700">Register</button>
        <div id="register-message-box" class="hidden mt-4 p-3 rounded-lg text-sm text-center font-medium"></div>
        <div class="flex justify-between mt-4 text-sm text-white/70">
        <button id="toggle-login" class="hidden text-blue-400 hover:text-blue-300">Already have an account? Login</button>
      </div>
      </form>

      <!-- Reset Password Form (NEW) -->
      <form id="reset-form" class="hidden">
        <h2 class="text-2xl font-bold mb-6 text-center">Reset Password</h2>
        <div class="mb-6">
          <label for="reset-email" class="block text-white/70 text-sm mb-2 text-left">Email Address</label>
          <input type="email" id="reset-email" class="w-full px-4 py-2 rounded-lg bg-gray-800 text-white border border-gray-700 focus:border-blue-500" placeholder="your.email@example.com" required>
        </div>
        <button type="submit" class="w-full bg-blue-600 py-2 rounded-lg font-semibold hover:bg-blue-700">Send Reset Link</button>
        <div id="reset-message-box" class="hidden mt-4 p-3 rounded-lg text-sm text-center font-medium"></div>
        <div class="flex justify-between mt-4 text-sm text-white/70">
        <button id="toggle-login" class="hidden text-blue-400 hover:text-blue-300">Already have an account? Login</button>
      </div>
      </form>

      <!-- Links -->
      <!--<div class="flex justify-between mt-4 text-sm text-white/70">
        <button id="toggle-register" class="text-blue-400 hover:text-blue-300">Don't have an account? Register</button>
        <button id="toggle-login" class="hidden text-blue-400 hover:text-blue-300">Already have an account? Login</button>
        <button id="toggle-reset" class="text-blue-400 hover:text-blue-300">Reset Password</button>
      </div>-->
    </div>
  </div>

  <!-- Firebase -->
  <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-app.js";
  import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-auth.js";
  import { getDatabase, ref, set } from "https://www.gstatic.com/firebasejs/10.13.2/firebase-database.js";

  // Firebase Config
  const firebaseConfig = {
    apiKey: "AIzaSyDMW41e3rKtk95dZk9-uM5s6rKbQaXPBbw",
    authDomain: "vediedu.firebaseapp.com",
    projectId: "vediedu",
    storageBucket: "vediedu.firebasestorage.app",
    messagingSenderId: "544144167054",
    appId: "1:544144167054:web:4c312b06396441b700b9df",
    measurementId: "G-N3TQ69XNED"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getDatabase(app);

  // Form references
  const loginForm = document.getElementById("login-form");
  const registerForm = document.getElementById("register-form");
  const resetForm = document.getElementById("reset-form");

  const loginEmailInput = document.getElementById("login-email");
  const loginPasswordInput = document.getElementById("login-password");
  const registerEmailInput = document.getElementById("register-email");
  const registerPasswordInput = document.getElementById("register-password");
  const confirmPasswordInput = document.getElementById("confirm-password");
  const resetEmailInput = document.getElementById("reset-email");

  const loginMessageBox = document.getElementById("login-message-box");
  const registerMessageBox = document.getElementById("register-message-box");
  const resetMessageBox = document.getElementById("reset-message-box");

  const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
  const passwordMinLength = 6;

  // ---------------------------
  // Input Glow Validation
  // ---------------------------
  function validateEmailInput(input) {
    if (input.value === "") {
      input.classList.remove("input-success", "input-error");
    } else if (emailRegex.test(input.value)) {
      input.classList.add("input-success");
      input.classList.remove("input-error");
    } else {
      input.classList.add("input-error");
      input.classList.remove("input-success");
    }
  }

  function validatePasswordInput(input, minLength = passwordMinLength) {
    if (input.value === "") {
      input.classList.remove("input-success", "input-error");
    } else if (input.value.length >= minLength) {
      input.classList.add("input-success");
      input.classList.remove("input-error");
    } else {
      input.classList.add("input-error");
      input.classList.remove("input-success");
    }
  }

  function validateConfirmPassword() {
    if (confirmPasswordInput.value === "") {
      confirmPasswordInput.classList.remove("input-success", "input-error");
    } else if (confirmPasswordInput.value === registerPasswordInput.value) {
      confirmPasswordInput.classList.add("input-success");
      confirmPasswordInput.classList.remove("input-error");
    } else {
      confirmPasswordInput.classList.add("input-error");
      confirmPasswordInput.classList.remove("input-success");
    }
  }

  // Attach validation listeners
  loginEmailInput?.addEventListener("input", () => validateEmailInput(loginEmailInput));
  loginPasswordInput?.addEventListener("input", () => validatePasswordInput(loginPasswordInput));
  registerEmailInput?.addEventListener("input", () => validateEmailInput(registerEmailInput));
  registerPasswordInput?.addEventListener("input", () => {
    validatePasswordInput(registerPasswordInput);
    validateConfirmPassword();
  });
  confirmPasswordInput?.addEventListener("input", validateConfirmPassword);
  resetEmailInput?.addEventListener("input", () => validateEmailInput(resetEmailInput));

  // ---------------------------
  // Toggle forms
  // ---------------------------
  document.getElementById("toggle-register").addEventListener("click", () => {
    loginForm.classList.add("hidden");
    registerForm.classList.remove("hidden");
    resetForm.classList.add("hidden");
    document.getElementById("toggle-register").classList.add("hidden");
    document.getElementById("toggle-login").classList.remove("hidden");
  });

  document.getElementById("toggle-login").addEventListener("click", () => {
    loginForm.classList.remove("hidden");
    registerForm.classList.add("hidden");
    resetForm.classList.add("hidden");
    document.getElementById("toggle-login").classList.add("hidden");
    document.getElementById("toggle-register").classList.remove("hidden");
  });

  document.getElementById("toggle-reset").addEventListener("click", () => {
    loginForm.classList.add("hidden");
    registerForm.classList.add("hidden");
    resetForm.classList.remove("hidden");
    document.getElementById("toggle-login").classList.remove("hidden");
    document.getElementById("toggle-register").classList.add("hidden");
  });

  // ---------------------------
  // Firebase Authentication
  // ---------------------------
  // Register
  registerForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const email = registerEmailInput.value;
    const password = registerPasswordInput.value;
    const confirm = confirmPasswordInput.value;

    if (password !== confirm) {
      registerMessageBox.textContent = "❌ Passwords do not match.";
      registerMessageBox.classList.remove("hidden");
      return;
    }

    try {
      const cred = await createUserWithEmailAndPassword(auth, email, password);
      await set(ref(db, "users/" + cred.user.uid), {
        email,
        createdAt: new Date().toISOString(),
      });
      registerMessageBox.textContent = "✅ Registration successful! Redirecting...";
      registerMessageBox.classList.remove("hidden");
      setTimeout(() => {
        window.location.href = "index.html";
      }, 1500);
    } catch (err) {
      registerMessageBox.textContent = "❌ " + err.message;
      registerMessageBox.classList.remove("hidden");
    }
  });

  // Login
  loginForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const email = loginEmailInput.value;
    const password = loginPasswordInput.value;

    try {
      await signInWithEmailAndPassword(auth, email, password);
      loginMessageBox.textContent = "✅ Login successful! Redirecting...";
      loginMessageBox.classList.remove("hidden");
      setTimeout(() => {
        window.location.href = "index.html";
      }, 1500);
    } catch (err) {
      loginMessageBox.textContent = "❌ " + err.message;
      loginMessageBox.classList.remove("hidden");
    }
  });

  // Reset Password
  resetForm.addEventListener("submit", async (e) => {
    e.preventDefault();
    const email = document.getElementById("reset-email").value;
    try {
      await sendPasswordResetEmail(auth, email);
      resetMessageBox.textContent = "📩 Password reset email sent!";
    } catch (err) {
      resetMessageBox.textContent = "❌ " + err.message;
    }
    resetMessageBox.classList.remove("hidden");
  });
</script>
</body>
</html>